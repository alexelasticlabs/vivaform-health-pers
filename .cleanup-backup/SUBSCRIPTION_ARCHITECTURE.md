# üí≥ VivaForm+ ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥–ø–∏—Å–∫–∏

## 1Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –†–æ–ª—å |
|-----------|------|
| **Frontend (React + Vite)** | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –æ–ø–ª–∞—Ç—É, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã |
| **Backend (NestJS)** | –°–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏–∏ –æ–ø–ª–∞—Ç—ã, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç webhooks, —É–ø—Ä–∞–≤–ª—è–µ—Ç –ë–î |
| **Stripe** | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–∏, —Ö—Ä–∞–Ω–∏—Ç —Å—Ç–∞—Ç—É—Å—ã –ø–æ–¥–ø–∏—Å–æ–∫ |
| **PostgreSQL (—á–µ—Ä–µ–∑ Prisma)** | –•—Ä–∞–Ω–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫ |
| **Webhook listener** | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç Stripe –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ |

## 2Ô∏è‚É£ –û–±—â–∏–π —Ü–∏–∫–ª –ø–æ–¥–ø–∏—Å–∫–∏

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç ¬´Activate VivaForm+¬ª**

2. **Frontend –≤—ã–∑—ã–≤–∞–µ—Ç** `POST /subscriptions/checkout` —Å —Ç–∏–ø–æ–º –ø–ª–∞–Ω–∞ (`monthly`, `quarterly`, `annual`)

3. **–°–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞—ë—Ç Stripe Checkout Session**, —É–∫–∞–∑—ã–≤–∞—è:
   - –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–ª–∞–Ω (—á–µ—Ä–µ–∑ price ID)
   - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤ metadata)
   - —Å—Å—ã–ª–∫–∏ –Ω–∞ —É—Å–ø–µ—Ö –∏ –æ—Ç–º–µ–Ω—É

4. **Stripe –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Checkout URL** ‚Üí —Ñ—Ä–æ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –µ—ë

5. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã** –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ Stripe

6. **–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã:**
   - Stripe —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–ø–∏—Å–∫–µ —É —Å–µ–±—è
   - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook –Ω–∞ –Ω–∞—à —Å–µ—Ä–≤–µ—Ä

7. **Backend –ø–æ–ª—É—á–∞–µ—Ç webhook**, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å—å –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–∑—É:
   - —Å–æ–∑–¥–∞—ë—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å `Subscription`
   - –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–æ–ª—å `PREMIUM`
   - —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏

8. **–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç** –ø—Ä–∏ –ª—é–±–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫ API –ø–æ–ª—É—á–∞–µ—Ç `role = PREMIUM`,
   —á—Ç–æ –¥–∞—ë—Ç –¥–æ—Å—Ç—É–ø –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º VivaForm

## 3Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ –¥–µ—Ç–∞–ª—è—Ö

### üîπ 1. –°–æ–∑–¥–∞–Ω–∏–µ Checkout Session

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø–ª–∞–Ω, —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ Stripe —Å –∑–∞–ø—Ä–æ—Å–æ–º:
- —Å–æ–∑–¥–∞—Ç—å –∏–ª–∏ –Ω–∞–π—Ç–∏ Customer –ø–æ `userId`
- —Å–æ–∑–¥–∞—Ç—å Checkout Session –≤ —Ä–µ–∂–∏–º–µ `subscription`
- –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ `userId` –∏ `plan`
- –≤–µ—Ä–Ω—É—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π `sessionUrl`

**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç Stripe:**
- Customer (email, payment method)
- Subscription (plan, price, cycle)
- Invoices (–∏—Å—Ç–æ—Ä–∏—è –æ–ø–ª–∞—Ç)

### üîπ 2. –ü–ª–∞—Ç—ë–∂ –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç ‚Üí Stripe –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É—Å–ø–µ—Ö ‚Üí
—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É VivaForm `/subscription/success`.

–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω–∞—è,
—Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –æ—Ç Stripe –Ω–∞ –Ω–∞—à Webhook.

### üîπ 3. –ü—Ä–∏—ë–º Webhook

Stripe –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (HTTP POST) –Ω–∞ `/webhooks/stripe`
–ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤ –ø–æ–¥–ø–∏—Å–∫–µ.

**–¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π:**
- `checkout.session.completed` ‚Äî –ø–æ–¥–ø–∏—Å–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞
- `customer.subscription.updated` ‚Äî –ø—Ä–æ–¥–ª–µ–Ω–∏–µ, –æ—Ç–º–µ–Ω–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ
- `customer.subscription.deleted` ‚Äî –ø–æ–¥–ø–∏—Å–∫–∞ —É–¥–∞–ª–µ–Ω–∞
- `invoice.payment_failed` ‚Äî –æ—à–∏–±–∫–∞ —Å–ø–∏—Å–∞–Ω–∏—è

**–ù–∞—à —Å–µ—Ä–≤–µ—Ä:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å Stripe (–ø–æ `STRIPE_WEBHOOK_SECRET`)
2. –ß–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–æ–±—ã—Ç–∏—è
3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –±–∞–∑—É VivaForm —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º Stripe

### üîπ 4. –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–¢–∞–±–ª–∏—Ü–∞ `Subscription` —Ö—Ä–∞–Ω–∏—Ç:
- ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`userId`)
- ID –∫–ª–∏–µ–Ω—Ç–∞ –∏ –ø–æ–¥–ø–∏—Å–∫–∏ –≤ Stripe (`stripeCustomerId`, `stripeSubscriptionId`)
- —Ç–µ–∫—É—â–∏–π –ø–ª–∞–Ω (`plan`)
- —Å—Ç–∞—Ç—É—Å (`active`, `trialing`, `canceled`, `past_due`)
- –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞ –ø–µ—Ä–∏–æ–¥–∞ (`currentPeriodStart`, `currentPeriodEnd`)
- —Ñ–ª–∞–≥ `cancelAtPeriodEnd` ‚Äî –æ—Ç–º–µ–Ω–∞ –ø–æ—Å–ª–µ –∫–æ–Ω—Ü–∞ —Ü–∏–∫–ª–∞

–ü—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ–±—ã—Ç–∏–∏ webhook —Å–µ—Ä–≤–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç —ç—Ç–∏ –ø–æ–ª—è.

### üîπ 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ API

–ö–æ–≥–¥–∞ —Ñ—Ä–æ–Ω—Ç –¥–µ–ª–∞–µ—Ç –ª—é–±–æ–π –∑–∞–ø—Ä–æ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/recommendations/latest`):
1. JWT-–¥–µ–∫–æ–¥–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç `userId` –≤ `req.user`
2. Middleware –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –≤ –±–∞–∑—É `Subscription`
3. –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ `active` –∏–ª–∏ `trialing`, —Ä–æ–ª—å = `PREMIUM`
4. –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–∞ –∏–ª–∏ –æ—Ç–º–µ–Ω–µ–Ω–∞ ‚Äî —Ä–æ–ª—å `USER`
5. Guards –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ NestJS —Ä–∞–∑—Ä–µ—à–∞—é—Ç –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –ø—Ä–µ–º–∏—É–º-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∫ –Ω—É–∂–Ω—ã–º endpoint'–∞–º

### üîπ 6. –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ –∏ –æ—Ç–º–µ–Ω–∞

Stripe —Å–∞–º –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –∫–∞–∂–¥—ã–µ N –º–µ—Å—è—Ü–µ–≤,
–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–∞–Ω–∞ (`interval = month`, `interval_count = 4, 12`).

**–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É:**
- Stripe –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook `customer.subscription.updated` —Å `cancel_at_period_end=true`
- —Å–µ—Ä–≤–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–∑—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:
  *"Your plan will expire on [–¥–∞—Ç–∞ –∫–æ–Ω—Ü–∞ —Ü–∏–∫–ª–∞]."*

–ö–æ–≥–¥–∞ —Å—Ä–æ–∫ –∏—Å—Ç–µ–∫–∞–µ—Ç, Stripe –ø—Ä–∏—Å—ã–ª–∞–µ—Ç `customer.subscription.deleted`,
–∏ VivaForm –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–Ω–∏–∂–∞–µ—Ç —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### üîπ 7. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π

–í –ø—Ä–æ—Ñ–∏–ª–µ –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ **"Manage billing"**.
–§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ã–∑—ã–≤–∞–µ—Ç `GET /subscriptions/portal`,
—Å–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞—ë—Ç Billing Portal Session –≤ Stripe –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∫—É.

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:**
- –∏–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ä—Ç—É
- –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- –ø–æ–º–µ–Ω—è—Ç—å –ø–ª–∞–Ω
- —Å–∫–∞—á–∞—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è Stripe —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–¥–∞—ë—Ç webhook'–∞–º–∏ –æ–±—Ä–∞—Ç–Ω–æ.

## 4Ô∏è‚É£ –°–≤—è–∑—å –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)

```
[Client: VivaForm Web/App]
        ‚Üì  (plan)
POST /subscriptions/checkout
        ‚Üì
[Backend: VivaForm API]
        ‚Üí  Create Checkout Session
        ‚Üê  session URL
        ‚Üì
[Stripe Hosted Checkout]
        ‚Üí  Payment Success
        ‚Ü≥  Webhook ‚Üí VivaForm API
        ‚Üì
[Database: Prisma/PostgreSQL]
        update Subscription + Role
        ‚Üì
[Frontend: Dashboard]
        shows "Premium Active" state
```

## 5Ô∏è‚É£ –í–∞—Ä–∏–∞–Ω—Ç—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

| –°—Ç–∞—Ç—É—Å Stripe | –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ VivaForm | –†–æ–ª—å |
|---------------|----------------------|------|
| `active` | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ Premium | `PREMIUM` |
| `trialing` | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (—Ç–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥) | `PREMIUM` |
| `canceled` | –î–æ—Å—Ç—É–ø –¥–æ –∫–æ–Ω—Ü–∞ —Ü–∏–∫–ª–∞ | `PREMIUM` |
| `past_due` | –í—Ä–µ–º–µ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Premium | `USER` |
| `incomplete` | –û—à–∏–±–∫–∞ –ø–ª–∞—Ç–µ–∂–∞, –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ | `USER` |
| `deleted` | –ü–æ–¥–ø–∏—Å–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ | `USER` |

## 6Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π –∏ –¥–æ—Å—Ç—É–ø–∞

–†–æ–ª—å `PREMIUM` **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –≤ JWT** ‚Äî
–æ–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API,
–∏—Å—Ö–æ–¥—è –∏–∑ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –±–∞–∑–µ.

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É —Ç–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø,
–±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–Ω–æ–≤–æ –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è.

## 7Ô∏è‚É£ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å

- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ Stripe –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º,
  —Ñ—Ä–æ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏
- Webhook –ø–æ–¥–ø–∏—Å–∞–Ω —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å—å—é Stripe –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
- –î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ —É Stripe (VivaForm –Ω–µ –≤–∏–¥–∏—Ç –∏ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Ö)
- –õ—é–±–∞—è –æ—à–∏–±–∫–∞ –∏–ª–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ webhook –ø—Ä–∏—à—ë–ª –±–µ–∑ `userId`)
- –î–æ—Å—Ç—É–ø –∫ –ø—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏—è–º –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ –∏ JWT

## 8Ô∏è‚É£ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

–ü—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ–±—ã—Ç–∏–∏ (–æ–ø–ª–∞—Ç–∞, –ø—Ä–æ–¥–ª–µ–Ω–∏–µ, –æ—Ç–º–µ–Ω–∞, –æ—à–∏–±–∫–∞):
- —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª–µ –∞—É–¥–∏—Ç–∞
- –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ (Firebase / Meta / Google Ads) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ:
  - `checkout_start`
  - `checkout_success`
  - `subscription_canceled`
  - `subscription_renewed`

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤.

## 9Ô∏è‚É£ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**Stripe** ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –æ –ø–ª–∞—Ç—ë–∂–Ω–æ–º —Å—Ç–∞—Ç—É—Å–µ,
–Ω–æ **VivaForm** —Ö—Ä–∞–Ω–∏—Ç –∑–µ—Ä–∫–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ UI.

–ï—Å–ª–∏ –≤ Stripe —á—Ç–æ-—Ç–æ –æ–±–Ω–æ–≤–∏–ª–æ—Å—å,
Webhook –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∏—Ö —Å—Ä–∞–∑—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–º–µ–Ω–∏–ª ‚Äî –±–∞–Ω–Ω–µ—Ä "Expires soon").

## üîü –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å

- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (trial), –∫—É–ø–æ–Ω–Ω—ã–µ —Å–∫–∏–¥–∫–∏, –ø–æ–¥–∞—Ä–æ—á–Ω—ã–µ –ø–ª–∞–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Stripe Dashboard
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã (—á–µ—Ä–µ–∑ —Ç–µ –∂–µ API)
- Stripe –±–µ—Ä—ë—Ç –Ω–∞ —Å–µ–±—è –≤—Å—é –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–∞–ª—é—Ç –∏ –ù–î–° (VAT)

---

## ‚úÖ –†–µ–∑—é–º–µ

–ü–æ–¥–ø–∏—Å–∫–∞ VivaForm+ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —á—ë—Ç–∫–∞—è —Å–≤—è–∑–∫–∞:

**Frontend ‚Üí Backend ‚Üí Stripe ‚Üí Webhook ‚Üí Database ‚Üí User Role ‚Üí UI**

- –í—Å—è –ª–æ–≥–∏–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ —Å—Ç–∞—Ç—É—Å–µ –∏–∑ Stripe
- –û–ø–ª–∞—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞ (PCI-DSS compliant)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ–º —Å–∞–º —á–µ—Ä–µ–∑ Billing Portal
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è, –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ —É—á–∞—Å—Ç–∏—è

---

## üîÑ –ö–∞—Ä—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (State Machine)

```
[NO_SUBSCRIPTION]
   ‚îÇ  (checkout success / webhook: checkout.session.completed)
   ‚ñº
[ACTIVE] ‚îÄ‚îÄ(user cancels at period end / webhook: customer.subscription.updated: cancel_at_period_end=true)‚îÄ‚îÄ‚ñ∫ [ACTIVE_PENDING_EXPIRY]
   ‚îÇ                                                                              ‚îÇ
   ‚îÇ (payment fails on renewal / webhook: invoice.payment_failed)                 ‚îÇ (period ends / webhook: customer.subscription.deleted)
   ‚ñº                                                                              ‚ñº
[PAST_DUE] ‚îÄ‚îÄ(payment recovered / webhook: invoice.payment_succeeded)‚îÄ‚îÄ‚ñ∫ [ACTIVE]      [EXPIRED]
```

**–î–æ–ø. –≤–µ—Ç–≤–∏:**
- `TRIALING` (–µ—Å–ª–∏ –≤–∫–ª—é—á–∏–º –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥) –≤–µ–¥—ë—Ç –≤ `ACTIVE` –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –æ–ø–ª–∞—Ç–µ –∏–ª–∏ –≤ `EXPIRED`, –µ—Å–ª–∏ –Ω–µ –æ–ø–ª–∞—á–µ–Ω–æ
- `INCOMPLETE` (–Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞) ‚Üí –ª–∏–±–æ –≤ `ACTIVE`, –ª–∏–±–æ –æ–±—Ä–∞—Ç–Ω–æ –≤ `NO_SUBSCRIPTION`

## üìä –û–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π

| –°–æ—Å—Ç–æ—è–Ω–∏–µ | –°—É—Ç—å | –ß—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –†–æ–ª—å |
|-----------|------|------------------------|------|
| `NO_SUBSCRIPTION` | –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–µ—Ç | –ë–∞–Ω–Ω–µ—Ä ¬´Activate VivaForm+¬ª | `USER` |
| `INCOMPLETE` | –û–ø–ª–∞—Ç–∞ –Ω–∞—á–∞—Ç–∞, –Ω–æ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ | ¬´Finish your purchase¬ª | `USER` |
| `TRIALING` (–æ–ø—Ü.) | –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –±–µ–∑ —Å–ø–∏—Å–∞–Ω–∏—è | ¬´Trial active until ‚Ä¶¬ª | `PREMIUM` |
| `ACTIVE` | –ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞, –¥–æ—Å—Ç—É–ø –æ—Ç–∫—Ä—ã—Ç | ¬´VivaForm+ active until ‚Ä¶¬ª | `PREMIUM` |
| `ACTIVE_PENDING_EXPIRY` | –û—Ç–º–µ–Ω–∞ –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø–µ—Ä–∏–æ–¥–∞ | ¬´Plan will expire on ‚Ä¶¬ª | `PREMIUM` |
| `PAST_DUE` | –ù–µ—É–¥–∞—á–Ω–æ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ/—Å–ø–∏—Å–∞–Ω–∏–µ | ¬´Payment issue ‚Äî update your card¬ª | `USER` |
| `EXPIRED` | –ü–æ–¥–ø–∏—Å–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ | –í–æ–∑–≤—Ä–∞—Ç –∫ Free, upsell | `USER` |

## üîÄ –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã

| –û—Ç | –ö—É–¥–∞ | –¢—Ä–∏–≥–≥–µ—Ä (Stripe webhook / —Å–æ–±—ã—Ç–∏–µ) | –î–µ–π—Å—Ç–≤–∏–µ VivaForm |
|----|------|-------------------------------------|-------------------|
| `NO_SUBSCRIPTION` | `ACTIVE` | `checkout.session.completed` ‚Üí `customer.subscription.created` | –°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –ø–æ–¥–ø–∏—Å–∫–∏, —Ä–æ–ª—å=`PREMIUM` |
| `ACTIVE` | `ACTIVE_PENDING_EXPIRY` | `customer.subscription.updated` (`cancel_at_period_end=true`) | –ü–æ–º–µ—Ç–∏—Ç—å –¥–∞—Ç—É –∏—Å—Ç–µ—á–µ–Ω–∏—è, –ø–æ–∫–∞–∑–∞—Ç—å –∂—ë–ª—Ç—ã–π –±–∞–Ω–Ω–µ—Ä |
| `ACTIVE` | `PAST_DUE` | `invoice.payment_failed` | –í—Ä–µ–º–µ–Ω–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å Premium, –ø–æ–∫–∞–∑–∞—Ç—å –∫—Ä–∞—Å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä |
| `PAST_DUE` | `ACTIVE` | `invoice.payment_succeeded` | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Premium, —É–±—Ä–∞—Ç—å –±–∞–Ω–Ω–µ—Ä |
| `ACTIVE_PENDING_EXPIRY` | `EXPIRED` | `customer.subscription.deleted` (–ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø–µ—Ä–∏–æ–¥–∞) | –†–æ–ª—å=`USER`, —Å–∫—Ä—ã—Ç—å Premium |
| `INCOMPLETE` | `ACTIVE` | `checkout.session.completed` | –ó–∞–≤–µ—Ä—à–∏—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ, —Ä–æ–ª—å=`PREMIUM` |
| `TRIALING` | `ACTIVE` | `invoice.paid` (–ø–µ—Ä–≤–∞—è —É—Å–ø–µ—à–Ω–∞—è) | –†–æ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è `PREMIUM`, –æ–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥ |
| `TRIALING` | `EXPIRED` | `customer.subscription.deleted` (trial ended, –Ω–µ –æ–ø–ª–∞—á–µ–Ω–æ) | –†–æ–ª—å=`USER` |

## ‚è±Ô∏è –¢–∞–π–º–ª–∞–π–Ω (—Ç–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π)

1. **–í—ã–±–æ—Ä –ø–ª–∞–Ω–∞** ‚Üí Checkout ‚Üí –£—Å–ø–µ—Ö

2. **Webhook:** `checkout.session.completed` ‚Üí —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è ‚Üí `ACTIVE`

3. **–î–æ –∫–æ–Ω—Ü–∞ –ø–µ—Ä–∏–æ–¥–∞** ‚Äî –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ

4. **–í –¥–µ–Ω—å –ø—Ä–æ–¥–ª–µ–Ω–∏—è:**
   - –£—Å–ø–µ—Ö ‚Üí –æ—Å—Ç–∞—ë—Ç—Å—è `ACTIVE` (–¥–∞—Ç–∞ –ø—Ä–æ–¥–ª–µ–Ω–∞)
   - –ù–µ—É–¥–∞—á–∞ ‚Üí `invoice.payment_failed` ‚Üí `PAST_DUE` (–±–∞–Ω–Ω–µ—Ä ¬´–æ–±–Ω–æ–≤–∏—Ç–µ –∫–∞—Ä—Ç—É¬ª)

5. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω—è–µ—Ç –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ** ‚Üí `customer.subscription.updated` (`cancel_at_period_end=true`) ‚Üí `ACTIVE_PENDING_EXPIRY`

6. **–ü–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø–µ—Ä–∏–æ–¥–∞** ‚Üí `customer.subscription.deleted` ‚Üí `EXPIRED` (—Ä–æ–ª—å=`USER`)

## üîó –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Ñ—Ä–æ–Ω—Ç–∞, –±—ç–∫–∞ –∏ Stripe

### –§—Ä–æ–Ω—Ç
- –ò–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç checkout, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Billing Portal, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç–∞—Ç—É—Å—ã
- –í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã –±–µ—Ä—ë—Ç –∏–∑ API `/subscriptions/status` –∏ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ë—ç–∫
- –°–æ–∑–¥–∞—ë—Ç Checkout Session, Portal Session
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç webhooks, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å—å, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É `Subscription` –∏ —Ä–æ–ª—å
- –Ø–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã –¥–ª—è UI (–Ω–µ —Ñ—Ä–æ–Ω—Ç)

### Stripe
- –•—Ä–∞–Ω–∏—Ç –ø–ª–∞—Ç–µ–∂–∏, —Å—Ç–∞—Ç—É—Å—ã, –¥–∞—Ç—ã –ø–µ—Ä–∏–æ–¥–æ–≤
- –°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–æ–æ–±—â–∞–µ—Ç –Ω–∞–º —á–µ—Ä–µ–∑ webhooks –æ–±–æ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

## üé® UI-—Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º

| –°—Ç–∞—Ç—É—Å | –ë–∞–Ω–Ω–µ—Ä/–ø–ª–∞—à–∫–∞ | CTA |
|--------|---------------|-----|
| `NO_SUBSCRIPTION` | Upsell-–±–ª–æ–∫ –∏ –∫–Ω–æ–ø–∫–∞ ¬´Activate VivaForm+¬ª | ¬´Activate VivaForm+¬ª |
| `INCOMPLETE` | ¬´Finish your purchase¬ª | ¬´Resume checkout¬ª |
| `TRIALING` | ¬´Trial active until ‚Ä¶¬ª | ¬´Manage billing¬ª |
| `ACTIVE` | ¬´VivaForm+ active until ‚Ä¶¬ª (–∑–µ–ª—ë–Ω–∞—è) | ¬´Manage billing¬ª |
| `ACTIVE_PENDING_EXPIRY` | ¬´Your plan will expire on ‚Ä¶¬ª (–∂—ë–ª—Ç–∞—è) | ¬´Resume subscription¬ª (–≤ Portal) |
| `PAST_DUE` | ¬´Payment issue ‚Äî update card¬ª (–∫—Ä–∞—Å–Ω–∞—è) | ¬´Update payment method¬ª |
| `EXPIRED` | Upsell | ¬´Activate VivaForm+¬ª |

## üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è)

- `premium_page_view` / `premium_plan_click(plan)`
- `subscription_checkout_start(plan)`
- `subscription_checkout_success(plan)` (—Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ webhook)
- `subscription_past_due` / `subscription_recovered`
- `subscription_cancel_at_period_end`
- `subscription_expired`

## üõ°Ô∏è –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

1. **–ï–∂–µ—á–∞—Å–Ω—ã–π reconcile-–¥–∂–æ–±** (–ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é): —Å–≤–µ—Ä—è—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã —Å Stripe (list subscriptions by customer) –∏ —á–∏–Ω–∏—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è

2. **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ webhook'–æ–≤**: —Å–æ–±—ã—Ç–∏—è –º–æ–≥—É—Ç –ø—Ä–∏–π—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–µ–ª–∞–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ

3. **–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞**: —Ä–æ–ª–∏ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –±—ç–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –∏–∑ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –ë–î (–Ω–µ –∑–∞—à–∏–≤–∞—é—Ç—Å—è –≤ —Ç–æ–∫–µ–Ω)

## üìã –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –±–∏–∑–Ω–µ—Å–∞

- **–û—Ç–º–µ–Ω–∞** = –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–Ω—Ü–∞ –æ–ø–ª–∞—á–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ (–Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø–æ—Ç–µ—Ä—è)
- **–û—à–∏–±–∫–∞ –ø–ª–∞—Ç–µ–∂–∞** = –≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–æ—Ç–µ—Ä—è Premium, –ø–æ–∫–∞ –Ω–µ –æ–±–Ω–æ–≤—è—Ç –∫–∞—Ä—Ç—É
- **–í–æ–∑–≤—Ä–∞—Ç –∫ Free** –Ω–µ —É–¥–∞–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏—Å—Ç–æ—Ä–∏—é
- **–ê–ø–≥—Ä–µ–π–¥/–¥–∞—É–Ω–≥—Ä–µ–π–¥ –ø–ª–∞–Ω–∞** ‚Äî —á–µ—Ä–µ–∑ Billing Portal; –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å—Ç—É–ø–∞—é—Ç —á–µ—Ä–µ–∑ webhooks
